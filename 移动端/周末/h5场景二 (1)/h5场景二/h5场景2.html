<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0">
    <style type="text/css">
        *{
            margin: 0;
            padding: 0;
        }
        html,body{
            width: 100%;
            height: 100%;
            overflow: hidden;
        }
        #main{
            width: 640px;
            height: 1008px;
            position: absolute;
            left: 50%;
            margin-left: -320px;
            top: 0;
            transform-origin: top;
            -webkit-transform-origin: top;


        }
        #loading{
            position: absolute;
            z-index: 10;
            background: black;
            width: 100%;
            height: 100%;
        }
        .processBox{
            width: 80%;
            margin: 0 10px;
            background: #FFFFFF;
            height: 40px;
            position: absolute;
            top:40%;
            left: 10%;
            overflow: hidden;
            border-radius: 10px;
        }
        .process{
            background-image: -webkit-linear-gradient(45deg,#b7deed 0%,#21b4e2 50%,#0fa6ea 75%,#0000FF 100%);
            width: 0%;
            height: 40px;
            background-size: 40px 40px;
            background-repeat: repeat-x;
            transition: 1s;
        }
        #phone{
            background:url("images/phoneBg.jpg") no-repeat;
            width: 100%;
            height: 100%;
            position: absolute;
            z-index: 9;
        }
        .phoneName{
            background:url("images/phoneHeadName.png") no-repeat 0 bottom;
            width: 262px;
            height: 89px;
            margin: 10% auto;
        }
        .listen{
            background: url("images/phoneBtn.png") no-repeat;
            width: 520px;
            height: 360px;
            position: absolute;
            left: 50%;
            margin-left: -260px;
            bottom: 0;
        }
        .listenStyle{
            z-index: -1;
            border: 2px solid #00FF00;
            border-radius: 50%;
            animation: move 1s ease-in-out infinite;
        }
        @keyframes move {
            0%{
                transform: scale(0.5);
                -webkit-transform: scale(0.5);
            }
            100%{
                transform: scale(1);
                -webkit-transform: scale(1);
            }
        }

        .listenStyle,.listenTouch{
            height: 170px;
            width: 170px;
            position: absolute;
            left:358px;
            top: 143px;
        }
        .speak{
            background: url("images/phoneKey.png"),no-repeat;
            width: 520px;
            height: 659px;
           position: absolute;
            left: 50%;
            margin-left: -260px;
            bottom:0;
            transform: translate(0,659px);
            -webkit-transform: translate(0,659px);
            transition: 1s;
        }
        .refuse{
            height: 140px;
            width:140px;
            position: absolute;
            left: 190px;
            bottom: 37px;
        }
        #message{
            position: absolute;
            z-index: 8;
            width: 100%;
            height: 100%;
            background: #eaeaea;
        }
        #messageText{
            width: 640px;
            height: 88px;
            background: url("images/messageText.png") no-repeat;
            position: absolute;
            left: 50%;
            margin-left: -320px;
            bottom: 0;
        }
        #message ul li{
            list-style: none;
            max-width: 360px;
            min-width: 300px;
            line-height: 40px;
            padding: 20px;
            background: #FFFFFF;
            border: 2px solid #cacaca;
            border-radius: 10px;
            margin: 20px 0;
            font-size: 30px;
            position: relative;
            transform: translate(0,20px);
            -webkit-transform: translate(0,20px);
            transition: 1s;
            -webkit-transition: 1s;
            opacity: 0;
        }
        #message ul li.left{
            float: left;
            left: 125px;
        }
        #message ul li.right{
            float: right;
            right: 125px;
            background: #a2e45c;
            border: 2px solid #96b474;
        }
        #message ul li img{
            position: absolute;
        }
        #message ul li.left img:nth-child(1){
            left:-100px;
            top:0;
        }
        #message ul li.left img:nth-child(2){
            left:-10px;
        }
        #message ul li.right img:nth-child(1){
            right:-100px;
            top:0;
        }
        #message ul li.right img:nth-child(2){
            right:-10px;
        }

        #cube{
            width: 100%;
            height: 100%;
            background: url("images/cubeBg.jpg") no-repeat;
            background-size: 100% 100%;
            position: absolute;
            z-index: 7;
            perspective: 800px;
        }
        #cubeBox{
            width: 510px;
            height: 510px;
            position: absolute;
            left:50%;
            top:50%;
            margin-left: -265px;
            margin-top: -265px;
            transform-style: preserve-3d;
            transform: scale(0.5) rotateX(45deg) rotateY(45deg);
            transform-origin: 255px 255px -255px;
            transition: 1s;
        }
        #cubeBox li{
            position: absolute;
            width: 100%;
            height: 100%;
        }
        #cubeBox li:nth-child(1){
            background: url(images/cubeImg1.png) no-repeat;
            left: 510px;
            transform-origin: left;
            -webkit-transform-origin: left;
            transform: rotateY(90deg);
            -webkit-transform: rotateY(90deg);
        }
        #cubeBox li:nth-child(2){
            background: url(images/cubeImg2.png) no-repeat;
            left:-510px;
            transform-origin: right;
            -webkit-transform-origin: right;
            transform: rotateY(-90deg);
            -webkit-transform: rotateY(-90deg);

        }
        #cubeBox li:nth-child(3){
            background: url(images/cubeImg3.png) no-repeat;
            top:-510px;
            transform-origin: bottom;
            -webkit-transform-origin: bottom;
            transform: rotateX(90deg);
            -webkit-transform: rotateX(90deg);
        }
        #cubeBox li:nth-child(4){
            background: url(images/cubeImg4.png) no-repeat;
            top:510px;
            transform-origin: top;
            -webkit-transform-origin: top;
            transform: rotateX(-90deg);
            -webkit-transform: rotateX(-90deg);
        }
        #cubeBox li:nth-child(5){
            background: url(images/cubeImg5.png) no-repeat;
            transform: translateZ(-510px);
            -webkit-transform: translateZ(-510px);
        }
        #cubeBox li:nth-child(6){
            background: url(images/cubeImg6.png) no-repeat;
            transform: translateZ(0px);
            -webkit-transform: translateZ(0px);
        }






    </style>
</head>
<body>
<div id="main">
    <div id="loading">
        <div class="processBox">
            <div class="process"></div>
        </div>
    </div>
    <div id="phone">
        <div class="phoneName"></div>
        <div class="listen">
            <div class="listenStyle"></div>
            <div class="listenTouch"></div>
        </div>
        <div class="speak">
            <div class="refuse"></div>
        </div>
    </div>

    <div id="message">
        <ul>
            <li class="left">
                <img src="images/messageHead1.png">
                <img src="images/messageArrow1.png">
               你好，部落猪~~
            </li>
            <li class="right">
                <img src="images/messageHead2.png" alt="">
                <img src="images/messageArrow2.png" alt="">
                hello,联盟狗~~
            </li>
            <li class="left">
                <img src="images/messageHead1.png">
                <img src="images/messageArrow1.png">
               天哪，你真高
            </li>
            <li class="right">
                <img src="images/messageHead2.png" alt="">
                <img src="images/messageArrow2.png" alt="">
                鲜血与雷鸣
            </li>
            <li class="left">
                <img src="images/messageHead1.png">
                <img src="images/messageArrow1.png">
                愿圣光与你同在
            </li>
            <li class="right">
                <img src="images/messageHead2.png" alt="">
                <img src="images/messageArrow2.png" alt="">
                Lok-Tar Ogar
            </li>
            <li class="left">
                <img src="images/messageHead1.png">
                <img src="images/messageArrow1.png">
                为了辛多雷的荣耀
            </li>
            <li class="right">
                <img src="images/messageHead2.png" alt="">
                <img src="images/messageArrow2.png" alt="">
                啊，美丽的自然
            </li>
            <li class="left">
                <img src="images/messageHead1.png">
                <img src="images/messageArrow1.png">
                你要小心那些活着的家伙
            </li>
        </ul>
        <div id="messageText"></div>
    </div>
    <div id="cube">
        <ul id="cubeBox">
            <li></li>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
        </ul>
    </div>




</div>



<script >
    var main=document.querySelector("#main");
    var desw=640;
    var desh=1008;
    var winw=document.documentElement.clientWidth;
    var winh=document.documentElement.clientHeight;
    if(winw/winh<desw/desh){
        main.style.webkitTransform="scale("+winh/desh+")";
    }else {
        main.style.webkitTransform="scale("+winw/desw+")";
    }
    function fnload() {
        var arr = ['phoneBg.jpg', 'cubeBg.jpg', 'cubeImg1.png', 'cubeImg2.png', 'cubeImg3.png', 'cubeImg4.png', 'cubeImg5.png', 'cubeImg6.png', 'phoneBtn.png', 'phoneKey.png', 'messageHead1.png', 'messageHead2.png', 'messageText.png', 'phoneHeadName.png'];
        var loading=document.querySelector("#loading");
        var process=document.querySelector(".process");
        var n=0;
        arr.forEach(function () {
             var oImg=new Image();
            oImg.src="images/"+arguments[0];
            oImg.onload=function () {
                n++;
                process.style.width=n/arr.length*100+"%";
                process.addEventListener("webkitTransitionEnd",function () {
                this.style.webkitTransition="";

                },false);
                if(n==arr.length&&loading){
                    setTimeout(function () {
                        main.removeChild(loading);
                        fnPhone.init();
                        loading=null;

                    },1000);
                }
            }
        })
    }
    fnload();
    var phone=document.querySelector("#phone");
    var speak=document.querySelector(".speak");
    var fnPhone={
        init:function () {
            phone.addEventListener("click",this.touch,false);
        },
        touch:function (e) {
            var target=e.target;
            if(target.className=="listenTouch"){
                target.parentNode.style.display="none";
                speak.style.webkitTransform="translate(0,0)";

            }else if(target.className=="refuse"){
                phone.style.webkitTransform="translate(0,"+desh+"px)";
                phone.style.webkitTransform="1s";
                window.setTimeout(function () {
                    main.removeChild(phone);
                    fnMessage();
                },1000)
            }
        }
    }

    var msg=document.querySelector("#message");
    var oLis=document.querySelectorAll("#message>ul>li");
    var oUl=document.querySelector("#message>ul");
    function fnMessage() {
        var n=0;
        var h=null;
        var timer=window.setInterval(function () {
            oLis[n].style.opacity="1";
            oLis[n].style.webkitTransform="translate(0,0)";
            h+=oLis[n].offsetHeight-30;
            n++;
            if(n>=3){
                window.setTimeout(function () {
                    oUl.style.webkitTransform="translate(0,"+(-h)+"px";
                    oUl.style.webkitTransition="1s";

                },1000);
                if(n==oLis.length){
                    window.clearInterval(timer);
                    window.setTimeout(function () {
                main.removeChild(msg);
                        fnCube()
                    },1000)
                }
            }
        },1000)
    }

    var cubeBox=document.querySelector("#cubeBox");
    function fnCube() {
        cubeBox.style.webkitTransform="scale(0.7) rotateX(-135deg) rotateY(-45deg)";
        var startX = -135;
        /*初始转动的角度*/
        var startY = -45;
        var x = null;
        /*滑动的距离*/
        var y = null;
        document.addEventListener("touchstart", start, false);
        document.addEventListener("touchmove", move, false);
        document.addEventListener("touchend", end, false);
        //滑动的距离就是转动的角度
        function start(e) {
            this.startTouch = {x: e.touches[0].pageX, y: e.touches[0].pageY}
        }

        function move(e) {
            this.flag = true;
            var moveTouch = {x: e.touches[0].pageX, y: e.touches[0].pageY}
            x = moveTouch.x - this.startTouch.x;
            y = moveTouch.y - this.startTouch.y;
            //startX+y(纵向移动的距离) = rotateX(新的转动的角度)
            cubeBox.style.webkitTransform = "scale(0.7) rotateX(" + (-(startX + y)) + "deg) rotateY(" + (-(startY+x)) + "deg)";

        }

        function end() {
            if(this.flag){
                /*更新起始值*/
                startX += y;
                startY += x;
                this.flag = false;
            }

        }



    }


</script>



</body>
</html>